import React from 'react';
import { FileText } from 'lucide-react';

interface ReportDisplayProps {
  report: string;
}

const ReportDisplay: React.FC<ReportDisplayProps> = ({ report }) => {
  // Simple markdown parsing for headers and bold text
  const parseMarkdown = (text: string) => {
    const lines = text.split('\n');
    const parsed: JSX.Element[] = [];
    
    lines.forEach((line, index) => {
      if (line.startsWith('## ')) {
        parsed.push(
          <h3 key={index} className="text-lg font-bold text-gray-900 mt-6 mb-3 first:mt-0">
            {line.replace('## ', '')}
          </h3>
        );
      } else if (line.startsWith('**') && line.endsWith('**')) {
        parsed.push(
          <h4 key={index} className="font-semibold text-gray-800 mt-4 mb-2">
            {line.replace(/\*\*/g, '')}
          </h4>
        );
      } else if (line.trim()) {
        // Handle inline bold text
        const boldRegex = /\*\*(.*?)\*\*/g;
        const parts = line.split(boldRegex);
        
        parsed.push(
          <p key={index} className="text-gray-700 mb-3 leading-relaxed">
            {parts.map((part, partIndex) => {
              // If it's an odd index, it means it was inside ** **
              if (partIndex % 2 === 1) {
                return <strong key={partIndex} className="font-semibold text-gray-900">{part}</strong>;
              }
              return part;
            })}
          </p>
        );
      } else if (line.trim() === '') {
        parsed.push(<div key={index} className="mb-2" />);
      }
    });
    
    return parsed;
  };

  return (
    <div className="medical-card rounded-2xl p-6">
      <div className="flex items-center gap-3 mb-6">
        <FileText className="w-6 h-6 text-blue-600" />
        <h2 className="text-xl font-bold">Medical Report</h2>
      </div>
      
      <div className="max-h-96 overflow-y-auto pr-4 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100">
        <div className="prose prose-sm max-w-none">
          {parseMarkdown(report)}
        </div>
      </div>
      
      <div className="mt-6 pt-4 border-t border-gray-200">
        <p className="text-xs text-gray-500 italic">
          This report is generated by AI and should be reviewed by a qualified medical professional.
        </p>
      </div>
    </div>
  );
};

export default ReportDisplay;